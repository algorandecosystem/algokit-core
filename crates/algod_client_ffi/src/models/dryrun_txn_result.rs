/*
 * Algod REST API.
 *
 * API endpoint for algod operations.
 *
 * The version of the OpenAPI document: 0.0.1
 * Contact: contact@algorand.com
 * Generated by: Rust OpenAPI Generator
 */

use crate::models;
use algod_client::models::DryrunTxnResult as RustDryrunTxnResult;

use crate::models::AccountStateDelta;
use crate::models::DryrunState;
use crate::models::StateDelta;

/// DryrunTxnResult contains any LogicSig or ApplicationCall program debug information and state updates from a dryrun.
#[derive(Clone, Debug, PartialEq, uniffi::Record)]
pub struct DryrunTxnResult {
    /// Disassembled program line by line.
    pub disassembly: Vec<String>,
    /// Disassembled lsig program line by line.
    pub logic_sig_disassembly: Option<Vec<String>>,
    pub logic_sig_trace: Option<Vec<DryrunState>>,
    pub logic_sig_messages: Option<Vec<String>>,
    pub app_call_trace: Option<Vec<DryrunState>>,
    pub app_call_messages: Option<Vec<String>>,
    pub global_delta: Option<StateDelta>,
    pub local_deltas: Option<Vec<AccountStateDelta>>,
    pub logs: Option<Vec<Vec<u8>>>,
    /// Budget added during execution of app call transaction.
    pub budget_added: Option<u32>,
    /// Budget consumed during execution of app call transaction.
    pub budget_consumed: Option<u32>,
}

impl From<RustDryrunTxnResult> for DryrunTxnResult {
    fn from(rust_struct: RustDryrunTxnResult) -> Self {
        Self {
            disassembly: rust_struct.disassembly.into_iter().collect(),
            logic_sig_disassembly: rust_struct
                .logic_sig_disassembly
                .map(|v| v.into_iter().collect()),
            logic_sig_trace: rust_struct
                .logic_sig_trace
                .map(|v| v.into_iter().map(|v| v.into()).collect()),
            logic_sig_messages: rust_struct
                .logic_sig_messages
                .map(|v| v.into_iter().collect()),
            app_call_trace: rust_struct
                .app_call_trace
                .map(|v| v.into_iter().map(|v| v.into()).collect()),
            app_call_messages: rust_struct
                .app_call_messages
                .map(|v| v.into_iter().collect()),
            global_delta: rust_struct.global_delta.map(|v| v.into()),
            local_deltas: rust_struct
                .local_deltas
                .map(|v| v.into_iter().map(|v| v.into()).collect()),
            logs: rust_struct.logs.map(|v| v.into_iter().collect()),
            budget_added: rust_struct.budget_added,
            budget_consumed: rust_struct.budget_consumed,
        }
    }
}
